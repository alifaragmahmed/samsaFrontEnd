<app-breadcrumb [breadcrumbList]="breadcrumbList"></app-breadcrumb>

<div class="box box-primary material-shadow w3-white table-responsive" >
  <div class="box-header">
    <button class="btn btn-primary" (click)="viewCreateModal()" style="margin: 5px"  > 
      <span class="fa fa-plus" ></span> {{ "add" | trans }}
    </button> 
    <button *ngIf="showRemoveButton" (click)="removeServices()" class="btn btn-danger" style="margin: 5px"  > 
      <span class="fa fa-trash" ></span>
    </button>
  </div>
  <br>
  <table datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger" class="table table-bordered text-center">
    <thead>
      <tr class="w3-hover-light-gray" >
        <th></th>
        <th>#</th>
        <th>{{ "name" | trans }}</th>
        <th>{{ "value" | trans }}</th>
        <!--
        <th>{{ "except_level" | trans }}</th>
        <th>{{ "division" | trans }}</th>
        <th>{{ "copy" | trans }}</th>
        <th>{{ "repeat" | trans }}</th>
        <th>{{ "additional_value" | trans }}</th>
        <th>{{ "installment_percent" | trans }}</th>
        <th>{{ "from_installment" | trans }}</th>
        -->
        <th>{{ "store" | trans }}</th>
        <th>{{ "type" | trans }}</th>
        <th></th>
      </tr>
    </thead>

    <tbody>
      <tr *ngFor="let item of serviceList index as i" >
        <td>
          <input type="checkbox" style="margin: 0px!important" class="w3-check" (click)="toggleFromTrash(item.id)"  >
        </td>
        <td>{{ i + 1 }}</td>
        <td>{{ item.name }}</td>
        <td>{{ item.value | currency: ' EGP '  }}</td>
        <!--
        <td>{{ item.level? item.level.name : '' }}</td>
        <td>{{ item.division? item.division.name : '' }}</td>
        <td>
          <i *ngIf="item.copy" class="fa fa-check-square w3-text-green" ></i>
          <i *ngIf="!item.copy" class="fa fa-close w3-text-red" ></i>
        </td>
        <td>
          <i *ngIf="item.repeat" class="fa fa-check-square w3-text-green" ></i>
          <i *ngIf="!item.repeat" class="fa fa-close w3-text-red" ></i>
        </td>
        <td>{{ item.additional_value | currency: ' EGP ' }}</td>
        <td>{{ item.installment_percent | percent }}</td>
        <td>{{ item.from_installment }}</td>
        -->
        <td>{{ item.store? item.store.name : '' }}</td>
        <td>{{ item.type }}</td>
        <td> 
          <button class="btn btn-warning fa fa-edit" (click)="showUpdateModal(item)" ></button>
        </td>
      </tr>
    </tbody>
  </table>

</div>


<app-service-create [loadServices]="loadServices" [showCreateModal]="showCreateModal" ></app-service-create>

<!-- remove modal -->
<div class="w3-modal w3-block" *ngIf="showRemoveModal"  role="dialog">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title">{{ "remove services" | trans }}</h4>
        </div>
        <div class="modal-body text-center">
            <i class="fa fa-spinner fa-spin w3-jumbo w3-text-indigo w3-center" ></i>
            <br>
            {{ trashList.size() }} - {{ "removed" | trans }} {{ trashList.size() + removed.length }}
        </div>
        <div class="modal-footer"> 
        </div>
      </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
  </div><!-- /.modal -->


  <div class="modal" id="updateModal"   role="dialog">
    <div class="modal-dialog" role="document">
      <div class="box box-primary modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" onclick="document.getElementById('updateModal').style.display='none'"  aria-label="Close"><span aria-hidden="true">&times;</span></button>
          <h4 class="modal-title">{{ "update service" | trans }}</h4>
        </div>
        <div class="modal-body"> 
          <table class="table" >
            <tr>
              <th>{{ "name" | trans }} *</th>
              <td>
                  <input type="text" class="form-control input-sm" [(ngModel)]="updateItem.name" required  >
              </td>
            </tr>
            <tr>
              <th>{{ "type" | trans }} *</th>
              <td>
                <select class="form-control input-sm" [(ngModel)]="updateItem.type" required >
                  <option>-- {{ "type" | trans }} --</option>
                  <option value="wz" >{{ "wz" | trans }}</option>
                  <option value="in" >{{ "in" | trans }}</option>
                </select>
              </td>
            </tr> 
            <tr>
              <th>{{ "value" | trans }}</th>
              <td>
                <input type="number" class="form-control input-sm" [(ngModel)]="updateItem.value" required  >
              </td>
            </tr>
            <tr>
              <th>{{ "except_level" | trans }}</th>
              <td>
                <input type="number" class="form-control input-sm" [(ngModel)]="updateItem.except_level_id" required  >
              </td>
            </tr>
            <tr>
              <th>{{ "division" | trans }}</th>
              <td>
                <input type="number" class="form-control input-sm" [(ngModel)]="updateItem.division_id" required  >
              </td>
            </tr>
            <tr>
              <th>{{ "copying" | trans }}</th>
              <td>
                <input type="checkbox" class="w3-check" [(ngModel)]="updateItem.copy"    >
              </td>
            </tr>
            <tr>
              <th>{{ "repeat" | trans }}</th>
              <td>
                <input type="checkbox" class="w3-check" [(ngModel)]="updateItem.repeat"    >
              </td>
            </tr>
            <tr>
              <th>{{ "additional_value" | trans }}</th>
              <td>
                <input type="number" class="form-control input-sm" [(ngModel)]="updateItem.additional_value"    >
              </td>
            </tr>
            <tr>
              <th>{{ "installment_percent" | trans }}</th>
              <td>
                <input type="number" class="form-control input-sm" [(ngModel)]="updateItem.installment_percent"    >
              </td>
            </tr>
            <tr>
              <th>{{ "from_installment" | trans }}</th>
              <td>
                <input type="number" class="form-control input-sm" [(ngModel)]="updateItem.from_installment_id"    >
              </td>
            </tr> 
          </table>
        </div>
        <div class="modal-footer text-right">
          <button type="button" class="btn btn-default" onclick="document.getElementById('updateModal').style.display='none'" >{{ "close" | trans }}</button>
          <button class="btn btn-primary" (click)="updateService()" >{{ "save" | trans }}</button>
        </div>
      </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
  </div><!-- /.modal --> 
